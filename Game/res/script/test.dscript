
for(i in 10){
    enemy(false);
    wait 10;
}

wait 20;

for(i in 10){
    enemy(true);
    wait 10;
}

task enemy(inv){
    set const c = 10;
    set const fr = 40;
    
    set x = _rx + 50;
    set dir = 140;
    set angvel = 5;
    set color = _green;
    
    if(inv){
        color = _blue;
        x = _lx - 50;
        dir = 40;
        angvel!!;
        color = _blue;
    }
    
    set e = enemy(x, 100, 45);
    e.setDir(dir);
    e.setSpd(8);
    
    set fire = rand(0, fr);
    
    for(i in 145){
        
        if(i % fr == fire){
            set dir2 = rand(0, 360);//angleToPlayer(e.getPos());
            
            for(d in 0, 360/c, 361){
                bullet(_needle, color, e.getPos(), dir2 + d, 2, 10);
            }
        }
        
        if(e.isDeleted()){
            return;
        }
        
        if(i == 30){
            e.setAngVel(angvel);
        }
        if(i == 115){
            e.setAngVel(0);
        }
        
        wait;
    }
    
    e.delete();
}